<html>
  <head>
    <link
      href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300"
      rel="stylesheet"
      type="text/css"
    />
    <style type="text/css">
      .form-style-8 {
        font-family: "Open Sans Condensed", arial, sans;
        width: 500px;
        padding: 30px;
        background: #ffffff;
        margin: 50px auto;
        box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.22);
        -moz-box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.22);
        -webkit-box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.22);
      }
      .form-style-8 h2 {
        background: #4d4d4d;
        text-transform: uppercase;
        font-family: "Open Sans Condensed", sans-serif;
        color: #797979;
        font-size: 18px;
        font-weight: 100;
        padding: 20px;
        margin: -30px -30px 30px -30px;
      }
      .form-style-8 input[type="text"],
      .form-style-8 input[type="date"],
      .form-style-8 input[type="datetime"],
      .form-style-8 input[type="email"],
      .form-style-8 input[type="number"],
      .form-style-8 input[type="search"],
      .form-style-8 input[type="time"],
      .form-style-8 input[type="url"],
      .form-style-8 input[type="password"],
      .form-style-8 textarea,
      .form-style-8 select {
        box-sizing: border-box;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        outline: none;
        display: block;
        width: 100%;
        padding: 7px;
        border: none;
        border-bottom: 1px solid #ddd;
        background: transparent;
        margin-bottom: 10px;
        font: 16px Arial, Helvetica, sans-serif;
        height: 45px;
      }
      .form-style-8 textarea {
        resize: none;
        overflow: hidden;
      }
      .form-style-8 input[type="button"],
      .form-style-8 input[type="submit"] {
        -moz-box-shadow: inset 0px 1px 0px 0px #45d6d6;
        -webkit-box-shadow: inset 0px 1px 0px 0px #45d6d6;
        box-shadow: inset 0px 1px 0px 0px #45d6d6;
        background-color: #2cbbbb;
        border: 1px solid #27a0a0;
        display: inline-block;
        cursor: pointer;
        color: #ffffff;
        font-family: "Open Sans Condensed", sans-serif;
        font-size: 14px;
        padding: 8px 18px;
        text-decoration: none;
        text-transform: uppercase;
      }
      .form-style-8 input[type="button"]:hover,
      .form-style-8 input[type="submit"]:hover {
        background: linear-gradient(to bottom, #34caca 5%, #30c9c9 100%);
        background-color: #34caca;
      }
      .loading {
        background-color: orange;
      }
      .success {
        background-color: green;
      }
      .error {
        background-color: #f44336;
      }
      /* The alert message box */
      .alert {
        padding: 20px;
        /* background-color: #f44336; Red */
        color: white;
        margin-bottom: 15px;
      }

      /* The close button */
      .closebtn {
        margin-left: 15px;
        color: white;
        font-weight: bold;
        float: right;
        font-size: 22px;
        line-height: 20px;
        cursor: pointer;
        transition: 0.3s;
      }

      /* When moving the mouse over the close button */
      .closebtn:hover {
        color: black;
      }
    </style>
    <script type="text/javascript">
      //auto expand textarea
      function adjust_textarea(h) {
        h.style.height = "20px";
        h.style.height = h.scrollHeight + "px";
      }
    </script>
    <script type="text/javascript">
      function sendLoad() {
        console.log(this.responseText);
        result = document.getElementById("result");
        alertBox = document.getElementById("alertBox");
        alertBox.style.display = "block";
        if (this.readyState == 4 && this.status > 400) {
          alertBox.style.backgroundColor = "red";
					result.textContent = this.statusText;
        } else if (this.readyState == 4 && this.status <= 299) {
          alertBox.style.backgroundColor = "green";
					result.textContent = "Success";
        }
      }

      function approveQABuild() {
        result = document.getElementById("result");
        result.textContent = "Sending";
        alertBox = document.getElementById("alertBox");
        alertBox.style.display = "block";
        alertBox.style.backgroundColor = "orange";

        var xhr = new XMLHttpRequest();
        xhr.onload = sendLoad;
        xhr.open(myForm.method, myForm.action + myForm.SHA.value, true);
        xhr.setRequestHeader(
          "Content-Type",
          "application/x-www-form-urlencoded"
        );
        xhr.setRequestHeader("Authorization", "token " + myForm.token.value);
        xhr.setRequestHeader("Accept", "application/vnd.github.v3+json");
        var j = {
          state: "success",
          target_url:
            "https://upload.wikimedia.org/wikipedia/en/1/1a/Thelegomoviesoundtrack.jpg",
          description: "Internal QA passed",
          context: "internal-qa"
        };
        xhr.send(JSON.stringify(j));
      }
    </script>
    <title>QA Build Distribution Approval</title>
  </head>
  <body>
    <div class="form-style-8">
      <div class="alert" id="alertBox" style="display:'none'">
        <span
          class="closebtn"
          onclick="this.parentElement.style.display='none';"
          >&times;</span
        >
        <div id="result"></div>
      </div>

      <h1>QA Build Distribution Approval</h1>
      <form
        action="https://api.github.com/repos/soulcycle/android-app/statuses/"
        method="POST"
        name="myForm"
      >
        <p>
          <label for="token">Token:</label>
          <input type="text" name="token" id="token" size="50" />
        </p>

        <p>
          <label for="SHA">Build Commit SHA:</label>
          <input type="text" name="SHA" id="SHA" id="SHA" size="50" />
        </p>

        <input value="Approve" type="button" onclick="approveQABuild()" />
      </form>
    </div>
    <script>
      var url_string = window.location.href;
      var url = new URL(url_string);
      var sha = url.searchParams.get("sha");
      if (sha) {
        document.getElementById("SHA").value = sha;
      }
    </script>
  </body>
</html>
